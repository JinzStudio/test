{{ define "main" }}
<main class="game-page container">
  <h1 class="game-title">{{ .Title }}</h1>
  {{ with .Params.description }}
    <p class="game-sub">{{ . }}</p>
  {{ end }}

  {{ with .Params.play_url }}
    {{ $play := relURL . }}
    <p>
      正在打开游戏… 如果没有自动跳转，点击这里：
      <a id="game-fallback" href="{{ $play }}">{{ $play }}</a>
    </p>

    <div id="game-jump" data-href="{{ $play }}"></div>

    <script>
      (function () {
        var el = document.getElementById('game-jump');
        if (!el) return;
        var u = el.getAttribute('data-href');
        if (!u) return;
        try { window.location.replace(u); }
        catch (e) { window.location.href = u; }
      })();
    </script>
  {{ else }}
    <p style="color:#c00">
      未配置 <code>play_url</code>。请在该游戏的
      <code>content/games/&lt;slug&gt;/index.md</code> Front Matter 中添加，例如：
      <code>play_url: "/games/cookie-clicker/index.html"</code>
    </p>
  {{ end }}

  <article class="post-content">{{ .Content }}</article>
</main>
{{ end }}
